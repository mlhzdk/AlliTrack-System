<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title data-translate="system_settings_page_title">System Settings - AlliTrack Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="../css/header-sidebar.css" />
    <link rel="stylesheet" href="../css/admin.css" />
    <link rel="stylesheet" href="../css/system-settings.css" />
    <script src="../js/preference-manager.js"></script>
    <script src="../js/admin-data-manager.js"></script>
</head>

<body>
    <!-- Mobile Warning Message -->
    <div class="mobile-warning" style="display: none;">
        <div class="icon">ðŸ“±</div>
        <h1>Admin Dashboard Not Available on Mobile</h1>
        <p>The Admin Dashboard is designed for use on larger screens (laptops, tablets, or desktop computers).
            Please access this feature from a device with a screen width of 768 pixels or larger.</p>
        <p>For mobile access, please use the regular user interface.</p>
        <a href="../../landing page/pages/index.html" class="mobile-btn">Go to Home Page</a>
    </div>

    <!-- Main Dashboard Content -->
    <div class="app" id="dashboardContent">
        <div class="shell">
            <!-- Sidebar -->
            <aside class="sidebar" role="navigation" aria-label="Main Sidebar">
                <div class="brand">
                    <div class="logo">
                        <img src="../pictures/AlliTrack Logo.png" alt="AlliTrack Logo" class="logo-img"
                            style="width: 32px; height: 32px;">
                    </div>
                    <div>
                        <div class="title">AlliTrack</div>
                        <div class="subtitle" data-translate="admin_dashboard">Admin Dashboard</div>
                    </div>
                </div>
                <nav class="nav" id="sidebarNav">
                    <a href="../pages/index-admin.html" data-section="dashboard" class="nav-link">
                        <i class="fas fa-chart-line"></i> <span data-translate="dashboard">Dashboard</span>
                    </a>

                    <div class="nav-section" data-translate="ticket_management">Ticket Management</div>
                    <a href="../pages/admin-tickets.html" data-section="tickets" class="nav-link">
                        <i class="fas fa-ticket-alt"></i> <span data-translate="all_tickets">All Tickets</span>
                    </a>
                    <a href="../pages/ticket-queue.html" data-section="ticket-queue" class="nav-link">
                        <i class="fas fa-list-ol"></i> <span data-translate="ticket_queue">Ticket Queue</span>
                    </a>
                    <a href="../pages/escalated-tickets.html" data-section="escalated-tickets" class="nav-link">
                        <i class="fas fa-exclamation-triangle"></i> <span data-translate="escalated_tickets">Escalated
                            Tickets</span>
                    </a>

                    <div class="nav-section" data-translate="user_management">User Management</div>
                    <a href="../pages/users.html" data-section="users" class="nav-link">
                        <i class="fas fa-users"></i> <span data-translate="users">Users</span>
                    </a>
                    <a href="../pages/agents.html" data-section="agents" class="nav-link">
                        <i class="fas fa-headset"></i> <span data-translate="support_agents">Support Agents</span>
                    </a>
                    <a href="../pages/roles-permissions.html" data-section="roles-permissions" class="nav-link">
                        <i class="fas fa-user-shield"></i> <span data-translate="roles_permissions">Roles &
                            Permissions</span>
                    </a>

                    <div class="nav-section" data-translate="analytics">Analytics</div>
                    <a href="../pages/reports.html" data-section="reports" class="nav-link">
                        <i class="fas fa-chart-bar"></i> <span data-translate="reports">Reports</span>
                    </a>
                    <a href="../pages/performance.html" data-section="performance" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i> <span data-translate="performance">Performance</span>
                    </a>
                    <a href="../pages/insights.html" data-section="insights" class="nav-link">
                        <i class="fas fa-chart-pie"></i> <span data-translate="insights">Insights</span>
                    </a>

                    <div class="nav-section" data-translate="system_admin">System Admin</div>
                    <a href="../pages/system-settings.html" class="active nav-link" data-section="system-settings">
                        <i class="fas fa-cogs"></i> <span data-translate="system_settings">System Settings</span>
                    </a>
                    <a href="../pages/announcements-admin.html" data-section="announcements" class="nav-link">
                        <i class="fas fa-bullhorn"></i> <span data-translate="announcements">Announcements</span>
                    </a>
                    <a href="../pages/audit-log.html" data-section="audit-log" class="nav-link">
                        <i class="fas fa-clipboard-list"></i> <span data-translate="audit_log">Audit Log</span>
                    </a>
                </nav>
                <div class="sidebar-footer">
                    <div class="version">v1.2.0</div>
                    <div>Business Alliance Inc.</div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="main">
                <!-- Header -->
                <header class="header">
                    <div class="search" role="search" aria-label="Search Settings">
                        <i class="fas fa-search" style="opacity:.6"></i>
                        <input id="q" placeholder="Search settings..." data-translate-placeholder="search_settings"
                            aria-label="Search settings" />
                    </div>
                    <div class="header-actions">
                        <div style="text-align:right">
                            <div style="font-weight:700" id="userNameDisplay">Admin User</div>
                            <div style="font-size:.82rem;color:var(--muted)" id="userEmailDisplay">admin@allitrack.com
                            </div>
                        </div>
                        <div class="account" id="accountBtn" aria-haspopup="true" aria-expanded="false">
                            <div class="avatar admin-avatar" id="userAvatar">AD</div>
                            <i class="fas fa-chevron-down" style="opacity:.85"></i>
                        </div>
                        <div class="account-menu" id="accountMenu">
                            <div class="arrow"></div>
                            <a href="../pages/profile-settings.html" data-translate="profile"
                                class="nav-link">Profile</a>
                            <a href="../pages/preferences.html" data-translate="settings" class="nav-link">Settings</a>
                            <a href="../pages/audit-log.html" data-translate="audit_log" class="nav-link">Audit Log</a>
                            <div class="divider"></div>
                            <a href="#" id="logoutBtn" data-translate="logout">Logout</a>
                        </div>
                    </div>
                </header>

                <!-- Settings Content -->
                <div class="content">
                    <div class="settings-content">
                        <!-- Page Header -->
                        <div class="settings-header">
                            <h1><i class="fas fa-cogs"></i> <span data-translate="system_settings">System
                                    Settings</span></h1>
                            <p class="settings-subtitle" data-translate="system_settings_subtitle">Configure system-wide
                                settings, preferences, and maintenance operations</p>
                        </div>

                        <!-- Settings Tabs -->
                        <div class="settings-tabs">
                            <button class="settings-tab active" data-tab="general">
                                <i class="fas fa-sliders-h"></i>
                                <span data-translate="general_settings">General</span>
                            </button>
                            <button class="settings-tab" data-tab="ticket">
                                <i class="fas fa-ticket-alt"></i>
                                <span data-translate="ticket_settings">Ticket</span>
                            </button>
                            <button class="settings-tab" data-tab="notification">
                                <i class="fas fa-bell"></i>
                                <span data-translate="notification_settings">Notification</span>
                            </button>
                            <button class="settings-tab" data-tab="security">
                                <i class="fas fa-shield-alt"></i>
                                <span data-translate="security_settings">Security</span>
                            </button>
                            <button class="settings-tab" data-tab="maintenance">
                                <i class="fas fa-tools"></i>
                                <span data-translate="maintenance">Maintenance</span>
                            </button>
                            <button class="settings-tab" data-tab="advanced">
                                <i class="fas fa-code"></i>
                                <span data-translate="advanced_settings">Advanced</span>
                            </button>
                        </div>

                        <!-- Settings Sections -->
                        <div class="settings-sections">
                            <!-- General Settings -->
                            <div class="settings-section active" id="general-settings">
                                <div class="settings-card">
                                    <h3><i class="fas fa-info-circle"></i> <span
                                            data-translate="application_settings">Application Settings</span></h3>
                                    <div class="form-group">
                                        <label data-translate="application_name">Application Name</label>
                                        <input type="text" class="form-control" value="AlliTrack Support System"
                                            data-translate-placeholder="application_name_placeholder">
                                        <small data-translate="application_name_help">Display name shown throughout the
                                            application</small>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="timezone">Timezone</label>
                                        <select class="form-control">
                                            <option value="UTC" selected>UTC (Coordinated Universal Time)</option>
                                            <option value="EST">Eastern Standard Time (EST)</option>
                                            <option value="PST">Pacific Standard Time (PST)</option>
                                            <option value="CET">Central European Time (CET)</option>
                                            <option value="IST">India Standard Time (IST)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="date_format">Date Format</label>
                                        <select class="form-control">
                                            <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                            <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                            <option value="YYYY-MM-DD" selected>YYYY-MM-DD</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="time_format">Time Format</label>
                                        <div class="radio-group">
                                            <label class="radio-label">
                                                <input type="radio" name="time_format" value="12h" checked>
                                                <span data-translate="12_hour_format">12-hour format (AM/PM)</span>
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="time_format" value="24h">
                                                <span data-translate="24_hour_format">24-hour format</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-language"></i> <span
                                            data-translate="localization">Localization</span></h3>
                                    <div class="form-group">
                                        <label data-translate="default_language">Default Language</label>
                                        <select class="form-control" id="defaultLanguage">
                                            <option value="en" selected>English</option>
                                            <option value="fil">Filipino</option>
                                        </select>
                                        <small data-translate="default_language_help">Default language for all
                                            users</small>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-paint-brush"></i> <span
                                            data-translate="appearance">Appearance</span></h3>
                                    <div class="form-group">
                                        <label data-translate="default_theme">Default Theme</label>
                                        <select class="form-control" id="defaultTheme">
                                            <option value="light">Light</option>
                                            <option value="dark">Dark</option>
                                            <option value="auto" selected>Auto (System Preference)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Ticket Settings -->
                            <div class="settings-section" id="ticket-settings">
                                <div class="settings-card">
                                    <h3><i class="fas fa-ticket-alt"></i> <span data-translate="ticket_workflow">Ticket
                                            Workflow</span></h3>
                                    <div class="form-group">
                                        <label data-translate="auto_assign_tickets">Auto-assign tickets</label>
                                        <div class="radio-group">
                                            <label class="radio-label">
                                                <input type="radio" name="auto_assign" value="enabled" checked>
                                                <span data-translate="auto_assign_enabled">Enabled (Round-robin)</span>
                                            </label>
                                            <label class="radio-label">
                                                <input type="radio" name="auto_assign" value="disabled">
                                                <span data-translate="auto_assign_disabled">Disabled (Manual
                                                    assignment)</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="default_priority">Default Priority</label>
                                        <select class="form-control">
                                            <option value="low" selected>Low</option>
                                            <option value="medium">Medium</option>
                                            <option value="high">High</option>
                                            <option value="urgent">Urgent</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="escalation_time">Auto-escalation Time</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="48" min="1" max="168">
                                            <span class="input-group-text" data-translate="hours">hours</span>
                                        </div>
                                        <small data-translate="escalation_time_help">Time before unresolved tickets are
                                            escalated</small>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-business-time"></i> <span data-translate="sla_settings">SLA
                                            Settings</span></h3>
                                    <div class="form-group">
                                        <label data-translate="sla_response_time">SLA Response Time</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="4" min="1" max="24">
                                            <span class="input-group-text" data-translate="hours">hours</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="sla_resolution_time">SLA Resolution Time</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="72" min="1" max="240">
                                            <span class="input-group-text" data-translate="hours">hours</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="slaNotifications" checked>
                                            <span data-translate="sla_notifications">Send SLA violation
                                                notifications</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-tags"></i> <span data-translate="ticket_categories">Ticket
                                            Categories</span></h3>
                                    <div class="form-group">
                                        <label data-translate="default_categories">Default Categories</label>
                                        <div class="categories-list">
                                            <div class="category-tag">
                                                <span>Technical Support</span>
                                                <button class="category-remove"><i class="fas fa-times"></i></button>
                                            </div>
                                            <div class="category-tag">
                                                <span>Billing</span>
                                                <button class="category-remove"><i class="fas fa-times"></i></button>
                                            </div>
                                            <div class="category-tag">
                                                <span>Feature Request</span>
                                                <button class="category-remove"><i class="fas fa-times"></i></button>
                                            </div>
                                            <div class="category-tag">
                                                <span>Bug Report</span>
                                                <button class="category-remove"><i class="fas fa-times"></i></button>
                                            </div>
                                        </div>
                                        <div class="category-add">
                                            <input type="text" class="form-control" placeholder="Add new category"
                                                data-translate-placeholder="add_category_placeholder">
                                            <button class="btn btn-secondary" data-translate="add">Add</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Notification Settings -->
                            <div class="settings-section" id="notification-settings">
                                <div class="settings-card">
                                    <h3><i class="fas fa-envelope"></i> <span data-translate="email_notifications">Email
                                            Notifications</span></h3>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="emailEnabled" checked>
                                            <span data-translate="enable_email_notifications">Enable email
                                                notifications</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="smtp_server">SMTP Server</label>
                                        <input type="text" class="form-control" value="smtp.allitrack.com">
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="smtp_port">SMTP Port</label>
                                        <input type="number" class="form-control" value="587">
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="sender_email">Sender Email</label>
                                        <input type="email" class="form-control" value="noreply@allitrack.com">
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="smtpAuth" checked>
                                            <span data-translate="smtp_authentication">SMTP Authentication
                                                Required</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-bell"></i> <span
                                            data-translate="notification_preferences">Notification Preferences</span>
                                    </h3>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="notifyNewTicket" checked>
                                            <span data-translate="notify_new_ticket">Notify on new ticket</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="notifyAssignment" checked>
                                            <span data-translate="notify_assignment">Notify on ticket assignment</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="notifyReply" checked>
                                            <span data-translate="notify_reply">Notify on ticket reply</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="notifyEscalation" checked>
                                            <span data-translate="notify_escalation">Notify on ticket escalation</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="notifySLA" checked>
                                            <span data-translate="notify_sla">Notify on SLA violation</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-mobile-alt"></i> <span data-translate="push_notifications">Push
                                            Notifications</span></h3>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="pushEnabled">
                                            <span data-translate="enable_push_notifications">Enable push
                                                notifications</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="push_provider">Push Notification Provider</label>
                                        <select class="form-control">
                                            <option value="firebase" selected>Firebase Cloud Messaging</option>
                                            <option value="onesignal">OneSignal</option>
                                            <option value="custom">Custom Provider</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="api_key">API Key</label>
                                        <input type="password" class="form-control" placeholder="Enter API key">
                                    </div>
                                </div>
                            </div>

                            <!-- Security Settings -->
                            <div class="settings-section" id="security-settings">
                                <div class="settings-card">
                                    <h3><i class="fas fa-lock"></i> <span
                                            data-translate="authentication">Authentication</span></h3>
                                    <div class="form-group">
                                        <label data-translate="password_policy">Password Policy</label>
                                        <div class="checkbox-group">
                                            <label class="checkbox-label">
                                                <input type="checkbox" id="requireComplex" checked>
                                                <span data-translate="require_complex_password">Require complex
                                                    passwords</span>
                                            </label>
                                            <label class="checkbox-label">
                                                <input type="checkbox" id="minLength" checked>
                                                <span data-translate="min_password_length">Minimum 8 characters</span>
                                            </label>
                                            <label class="checkbox-label">
                                                <input type="checkbox" id="requireNumbers" checked>
                                                <span data-translate="require_numbers">Require numbers</span>
                                            </label>
                                            <label class="checkbox-label">
                                                <input type="checkbox" id="requireSymbols">
                                                <span data-translate="require_symbols">Require special characters</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="session_timeout">Session Timeout</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="60" min="5" max="480">
                                            <span class="input-group-text" data-translate="minutes">minutes</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="multiFactor" checked>
                                            <span data-translate="enable_2fa">Enable Two-Factor Authentication</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-shield-alt"></i> <span
                                            data-translate="security_policies">Security Policies</span></h3>
                                    <div class="form-group">
                                        <label data-translate="failed_login_attempts">Failed Login Attempts</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="5" min="1" max="10">
                                            <span data-translate="attempts">attempts before lockout</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="account_lockout">Account Lockout Duration</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="30" min="5" max="240">
                                            <span class="input-group-text" data-translate="minutes">minutes</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="ipWhitelist">
                                            <span data-translate="enable_ip_whitelist">Enable IP Whitelist</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="httpsOnly" checked>
                                            <span data-translate="force_https">Force HTTPS connections</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-user-shield"></i> <span data-translate="access_control">Access
                                            Control</span></h3>
                                    <div class="form-group">
                                        <label data-translate="admin_ip_restriction">Admin IP Restrictions</label>
                                        <textarea class="form-control" rows="3"
                                            placeholder="Enter allowed IP addresses (one per line)"
                                            data-translate-placeholder="ip_restriction_placeholder"></textarea>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="auditLogging" checked>
                                            <span data-translate="enable_audit_log">Enable audit logging</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="apiSecurity" checked>
                                            <span data-translate="enable_api_security">Enable API security</span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Maintenance Settings -->
                            <div class="settings-section" id="maintenance-settings">
                                <div class="settings-card">
                                    <h3><i class="fas fa-database"></i> <span
                                            data-translate="database_maintenance">Database Maintenance</span></h3>
                                    <div class="form-group">
                                        <label data-translate="backup_schedule">Backup Schedule</label>
                                        <select class="form-control">
                                            <option value="daily" selected>Daily</option>
                                            <option value="weekly">Weekly</option>
                                            <option value="monthly">Monthly</option>
                                            <option value="manual">Manual Only</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="retention_period">Retention Period</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="90" min="7" max="365">
                                            <span class="input-group-text" data-translate="days">days</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="autoBackup" checked>
                                            <span data-translate="enable_auto_backup">Enable automatic backups</span>
                                        </label>
                                    </div>
                                    <div class="maintenance-actions">
                                        <button class="btn btn-secondary" data-translate="backup_now">Backup
                                            Now</button>
                                        <button class="btn btn-outline" data-translate="optimize_db">Optimize
                                            Database</button>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-trash-alt"></i> <span data-translate="data_retention">Data
                                            Retention</span></h3>
                                    <div class="form-group">
                                        <label data-translate="ticket_retention">Ticket Retention Period</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="365" min="30" max="730">
                                            <span class="input-group-text" data-translate="days">days</span>
                                        </div>
                                        <small data-translate="ticket_retention_help">Closed tickets older than this
                                            will be archived</small>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="log_retention">Log Retention Period</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="180" min="30" max="365">
                                            <span class="input-group-text" data-translate="days">days</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="user_retention">Inactive User Retention</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="180" min="30" max="730">
                                            <span class="input-group-text" data-translate="days">days</span>
                                        </div>
                                        <small data-translate="user_retention_help">Users inactive for this period will
                                            be deactivated</small>
                                    </div>
                                    <div class="maintenance-actions">
                                        <button class="btn btn-outline" data-translate="cleanup_now">Run Cleanup
                                            Now</button>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-server"></i> <span data-translate="system_maintenance">System
                                            Maintenance</span></h3>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="maintenanceMode">
                                            <span data-translate="enable_maintenance_mode">Enable Maintenance
                                                Mode</span>
                                        </label>
                                        <small data-translate="maintenance_mode_help">Users will see a maintenance
                                            message</small>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="maintenance_message">Maintenance Message</label>
                                        <textarea class="form-control" rows="3"
                                            data-translate-placeholder="maintenance_message_placeholder">System is undergoing maintenance. We'll be back shortly.</textarea>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="autoUpdate">
                                            <span data-translate="auto_system_updates">Automatic System Updates</span>
                                        </label>
                                    </div>
                                    <div class="maintenance-actions">
                                        <button class="btn btn-primary" data-translate="check_updates">Check for
                                            Updates</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Advanced Settings -->
                            <div class="settings-section" id="advanced-settings">
                                <div class="settings-card warning">
                                    <h3><i class="fas fa-exclamation-triangle"></i> <span
                                            data-translate="warning">Warning</span></h3>
                                    <p data-translate="advanced_settings_warning">These settings are for advanced users
                                        only. Incorrect configuration may cause system instability.</p>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-code"></i> <span data-translate="api_settings">API
                                            Settings</span></h3>
                                    <div class="form-group">
                                        <label data-translate="api_rate_limit">API Rate Limit</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="100" min="10" max="1000">
                                            <span class="input-group-text"
                                                data-translate="requests_per_minute">requests/minute</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enableAPI" checked>
                                            <span data-translate="enable_rest_api">Enable REST API</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enableWebhooks">
                                            <span data-translate="enable_webhooks">Enable Webhooks</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-tachometer-alt"></i> <span
                                            data-translate="performance_settings">Performance Settings</span></h3>
                                    <div class="form-group">
                                        <label data-translate="cache_duration">Cache Duration</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="300" min="60" max="3600">
                                            <span class="input-group-text" data-translate="seconds">seconds</span>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enableCaching" checked>
                                            <span data-translate="enable_caching">Enable Response Caching</span>
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enableCompression" checked>
                                            <span data-translate="enable_compression">Enable GZIP Compression</span>
                                        </label>
                                    </div>
                                </div>

                                <div class="settings-card">
                                    <h3><i class="fas fa-cogs"></i> <span data-translate="debug_settings">Debug
                                            Settings</span></h3>
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enableDebug">
                                            <span data-translate="enable_debug_mode">Enable Debug Mode</span>
                                        </label>
                                        <small data-translate="debug_mode_help">Shows detailed error messages (for
                                            development only)</small>
                                    </div>
                                    <div class="form-group">
                                        <label data-translate="log_level">Log Level</label>
                                        <select class="form-control">
                                            <option value="error">Error Only</option>
                                            <option value="warn">Warning</option>
                                            <option value="info" selected>Info</option>
                                            <option value="debug">Debug</option>
                                        </select>
                                    </div>
                                    <div class="maintenance-actions">
                                        <button class="btn btn-outline" data-translate="view_logs">View System
                                            Logs</button>
                                        <button class="btn btn-outline" data-translate="clear_cache">Clear
                                            Cache</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="settings-actions">
                            <button class="btn btn-secondary" data-translate="discard_changes">Discard Changes</button>
                            <button class="btn btn-primary" id="saveSettingsBtn" data-translate="save_settings">Save
                                Settings</button>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <footer class="site-footer">
                    <div>&copy; 2025 Business Alliance Inc.</div>
                    <div data-translate="admin_dashboard_template">Admin Dashboard Template</div>
                </footer>
            </main>
        </div>
    </div>

    <script>
        // Translation dictionary for system settings page
        const translations = {
            'en': {
                // PAGE-SPECIFIC translations only:
                'system_settings_page_title': 'System Settings - AlliTrack Admin',
                'system_settings': 'System Settings',
                'system_settings_subtitle': 'Configure system-wide settings, preferences, and maintenance operations',
                'search_settings': 'Search settings...',
                'general_settings': 'General',
                'ticket_settings': 'Ticket',
                'notification_settings': 'Notification',
                'security_settings': 'Security',
                'maintenance': 'Maintenance',
                'advanced_settings': 'Advanced',
                'application_settings': 'Application Settings',
                'application_name': 'Application Name',
                'application_name_placeholder': 'Enter application name',
                'application_name_help': 'Display name shown throughout the application',
                'timezone': 'Timezone',
                'date_format': 'Date Format',
                'time_format': 'Time Format',
                '12_hour_format': '12-hour format (AM/PM)',
                '24_hour_format': '24-hour format',
                'localization': 'Localization',
                'default_language': 'Default Language',
                'default_language_help': 'Default language for all users',
                'auto_detect_language': 'Auto-detect user language',
                'allow_user_language': 'Allow users to change language',
                'appearance': 'Appearance',
                'default_theme': 'Default Theme',
                'allow_user_theme': 'Allow users to change theme',
                'accent_color': 'Accent Color',
                'customize_accent': 'Customize accent color',
                'ticket_workflow': 'Ticket Workflow',
                'auto_assign_tickets': 'Auto-assign tickets',
                'auto_assign_enabled': 'Enabled (Round-robin)',
                'auto_assign_disabled': 'Disabled (Manual assignment)',
                'default_priority': 'Default Priority',
                'escalation_time': 'Auto-escalation Time',
                'hours': 'hours',
                'escalation_time_help': 'Time before unresolved tickets are escalated',
                'sla_settings': 'SLA Settings',
                'sla_response_time': 'SLA Response Time',
                'sla_resolution_time': 'SLA Resolution Time',
                'sla_notifications': 'Send SLA violation notifications',
                'ticket_categories': 'Ticket Categories',
                'default_categories': 'Default Categories',
                'add_category_placeholder': 'Add new category',
                'add': 'Add',
                'email_notifications': 'Email Notifications',
                'enable_email_notifications': 'Enable email notifications',
                'smtp_server': 'SMTP Server',
                'smtp_port': 'SMTP Port',
                'sender_email': 'Sender Email',
                'smtp_authentication': 'SMTP Authentication Required',
                'notification_preferences': 'Notification Preferences',
                'notify_new_ticket': 'Notify on new ticket',
                'notify_assignment': 'Notify on ticket assignment',
                'notify_reply': 'Notify on ticket reply',
                'notify_escalation': 'Notify on ticket escalation',
                'notify_sla': 'Notify on SLA violation',
                'push_notifications': 'Push Notifications',
                'enable_push_notifications': 'Enable push notifications',
                'push_provider': 'Push Notification Provider',
                'api_key': 'API Key',
                'authentication': 'Authentication',
                'password_policy': 'Password Policy',
                'require_complex_password': 'Require complex passwords',
                'min_password_length': 'Minimum 8 characters',
                'require_numbers': 'Require numbers',
                'require_symbols': 'Require special characters',
                'session_timeout': 'Session Timeout',
                'minutes': 'minutes',
                'enable_2fa': 'Enable Two-Factor Authentication',
                'security_policies': 'Security Policies',
                'failed_login_attempts': 'Failed Login Attempts',
                'attempts': 'attempts before lockout',
                'account_lockout': 'Account Lockout Duration',
                'enable_ip_whitelist': 'Enable IP Whitelist',
                'force_https': 'Force HTTPS connections',
                'access_control': 'Access Control',
                'admin_ip_restriction': 'Admin IP Restrictions',
                'ip_restriction_placeholder': 'Enter allowed IP addresses (one per line)',
                'enable_audit_log': 'Enable audit logging',
                'enable_api_security': 'Enable API security',
                'database_maintenance': 'Database Maintenance',
                'backup_schedule': 'Backup Schedule',
                'retention_period': 'Retention Period',
                'days': 'days',
                'enable_auto_backup': 'Enable automatic backups',
                'backup_now': 'Backup Now',
                'optimize_db': 'Optimize Database',
                'data_retention': 'Data Retention',
                'ticket_retention': 'Ticket Retention Period',
                'ticket_retention_help': 'Closed tickets older than this will be archived',
                'log_retention': 'Log Retention Period',
                'user_retention': 'Inactive User Retention',
                'user_retention_help': 'Users inactive for this period will be deactivated',
                'cleanup_now': 'Run Cleanup Now',
                'system_maintenance': 'System Maintenance',
                'enable_maintenance_mode': 'Enable Maintenance Mode',
                'maintenance_mode_help': 'Users will see a maintenance message',
                'maintenance_message': 'Maintenance Message',
                'maintenance_message_placeholder': 'Enter maintenance message',
                'auto_system_updates': 'Automatic System Updates',
                'check_updates': 'Check for Updates',
                'warning': 'Warning',
                'advanced_settings_warning': 'These settings are for advanced users only. Incorrect configuration may cause system instability.',
                'api_settings': 'API Settings',
                'api_rate_limit': 'API Rate Limit',
                'requests_per_minute': 'requests/minute',
                'enable_rest_api': 'Enable REST API',
                'enable_webhooks': 'Enable Webhooks',
                'performance_settings': 'Performance Settings',
                'cache_duration': 'Cache Duration',
                'seconds': 'seconds',
                'enable_caching': 'Enable Response Caching',
                'enable_compression': 'Enable GZIP Compression',
                'debug_settings': 'Debug Settings',
                'enable_debug_mode': 'Enable Debug Mode',
                'debug_mode_help': 'Shows detailed error messages (for development only)',
                'log_level': 'Log Level',
                'view_logs': 'View System Logs',
                'clear_cache': 'Clear Cache',
                'discard_changes': 'Discard Changes',
                'save_settings': 'Save Settings',
                'admin_dashboard': 'Admin Dashboard',
                'dashboard': 'Dashboard',
                'ticket_management': 'Ticket Management',
                'all_tickets': 'All Tickets',
                'ticket_queue': 'Ticket Queue',
                'escalated_tickets': 'Escalated Tickets',
                'user_management': 'User Management',
                'users': 'Users',
                'support_agents': 'Support Agents',
                'roles_permissions': 'Roles & Permissions',
                'analytics': 'Analytics',
                'reports': 'Reports',
                'performance': 'Performance',
                'insights': 'Insights',
                'system_admin': 'System Admin',
                'announcements': 'Announcements',
                'audit_log': 'Audit Log',
                'profile': 'Profile',
                'settings': 'Settings',
                'logout': 'Logout',
                'admin_dashboard_template': 'Admin Dashboard Template'
            },
            'fil': {
                // PAGE-SPECIFIC translations only:
                'system_settings_page_title': 'System Settings - AlliTrack Admin',
                'system_settings': 'Mga System Setting',
                'system_settings_subtitle': 'I-configure ang system-wide na mga setting, kagustuhan, at maintenance operations',
                'search_settings': 'Maghanap ng mga setting...',
                'general_settings': 'Pangkalahatan',
                'ticket_settings': 'Ticket',
                'notification_settings': 'Abiso',
                'security_settings': 'Seguridad',
                'maintenance': 'Maintenance',
                'advanced_settings': 'Advanced',
                'application_settings': 'Mga Application Setting',
                'application_name': 'Pangalan ng Application',
                'application_name_placeholder': 'Ilagay ang pangalan ng application',
                'application_name_help': 'Display name na ipinapakita sa buong application',
                'timezone': 'Timezone',
                'date_format': 'Format ng Petsa',
                'time_format': 'Format ng Oras',
                '12_hour_format': '12-hour format (AM/PM)',
                '24_hour_format': '24-hour format',
                'localization': 'Localization',
                'default_language': 'Default na Wika',
                'default_language_help': 'Default na wika para sa lahat ng user',
                'auto_detect_language': 'Auto-detect ng wika ng user',
                'allow_user_language': 'Payagan ang mga user na palitan ang wika',
                'appearance': 'Itsura',
                'default_theme': 'Default na Tema',
                'allow_user_theme': 'Payagan ang mga user na palitan ang tema',
                'accent_color': 'Accent Color',
                'customize_accent': 'I-customize ang accent color',
                'ticket_workflow': 'Ticket Workflow',
                'auto_assign_tickets': 'Auto-assign ng mga ticket',
                'auto_assign_enabled': 'Enabled (Round-robin)',
                'auto_assign_disabled': 'Disabled (Manual assignment)',
                'default_priority': 'Default na Priority',
                'escalation_time': 'Auto-escalation Time',
                'hours': 'oras',
                'escalation_time_help': 'Oras bago i-escalate ang mga hindi nareresolbang ticket',
                'sla_settings': 'Mga SLA Setting',
                'sla_response_time': 'SLA Response Time',
                'sla_resolution_time': 'SLA Resolution Time',
                'sla_notifications': 'Magpadala ng abiso sa SLA violation',
                'ticket_categories': 'Mga Kategorya ng Ticket',
                'default_categories': 'Default na mga Kategorya',
                'add_category_placeholder': 'Magdagdag ng bagong kategorya',
                'add': 'Idagdag',
                'email_notifications': 'Mga Email Abiso',
                'enable_email_notifications': 'Paganahin ang mga email abiso',
                'smtp_server': 'SMTP Server',
                'smtp_port': 'SMTP Port',
                'sender_email': 'Sender Email',
                'smtp_authentication': 'Kinakailangan ang SMTP Authentication',
                'notification_preferences': 'Mga Kagustuhan sa Abiso',
                'notify_new_ticket': 'Abisuhan sa bagong ticket',
                'notify_assignment': 'Abisuhan sa ticket assignment',
                'notify_reply': 'Abisuhan sa ticket reply',
                'notify_escalation': 'Abisuhan sa ticket escalation',
                'notify_sla': 'Abisuhan sa SLA violation',
                'push_notifications': 'Mga Push Abiso',
                'enable_push_notifications': 'Paganahin ang mga push abiso',
                'push_provider': 'Push Notification Provider',
                'api_key': 'API Key',
                'authentication': 'Authentication',
                'password_policy': 'Password Policy',
                'require_complex_password': 'Mangailangan ng complex password',
                'min_password_length': 'Minimum na 8 character',
                'require_numbers': 'Mangailangan ng mga numero',
                'require_symbols': 'Mangailangan ng special characters',
                'session_timeout': 'Session Timeout',
                'minutes': 'minuto',
                'enable_2fa': 'Paganahin ang Two-Factor Authentication',
                'security_policies': 'Mga Security Policy',
                'failed_login_attempts': 'Mga Nabigong Login Attempt',
                'attempts': 'attempts bago lockout',
                'account_lockout': 'Tagal ng Account Lockout',
                'enable_ip_whitelist': 'Paganahin ang IP Whitelist',
                'force_https': 'Pilitin ang HTTPS connections',
                'access_control': 'Access Control',
                'admin_ip_restriction': 'Mga Admin IP Restriction',
                'ip_restriction_placeholder': 'Ilagay ang mga pinapayagang IP address (isang linya bawat isa)',
                'enable_audit_log': 'Paganahin ang audit logging',
                'enable_api_security': 'Paganahin ang API security',
                'database_maintenance': 'Database Maintenance',
                'backup_schedule': 'Backup Schedule',
                'retention_period': 'Retention Period',
                'days': 'araw',
                'enable_auto_backup': 'Paganahin ang automatic backups',
                'backup_now': 'Backup Ngayon',
                'optimize_db': 'I-optimize ang Database',
                'data_retention': 'Data Retention',
                'ticket_retention': 'Ticket Retention Period',
                'ticket_retention_help': 'Ang mga saradong ticket na mas matanda dito ay i-a-archive',
                'log_retention': 'Log Retention Period',
                'user_retention': 'Inactive User Retention',
                'user_retention_help': 'Mga user na hindi active sa loob ng panahong ito ay i-de-deactivate',
                'cleanup_now': 'Mag-run ng Cleanup Ngayon',
                'system_maintenance': 'System Maintenance',
                'enable_maintenance_mode': 'Paganahin ang Maintenance Mode',
                'maintenance_mode_help': 'Makikita ng mga user ang maintenance message',
                'maintenance_message': 'Maintenance Message',
                'maintenance_message_placeholder': 'Ilagay ang maintenance message',
                'auto_system_updates': 'Automatic System Updates',
                'check_updates': 'Maghanap ng mga Update',
                'warning': 'Babala',
                'advanced_settings_warning': 'Para lamang ito sa advanced users. Maaaring magdulot ng system instability ang maling configuration.',
                'api_settings': 'Mga API Setting',
                'api_rate_limit': 'API Rate Limit',
                'requests_per_minute': 'requests/minuto',
                'enable_rest_api': 'Paganahin ang REST API',
                'enable_webhooks': 'Paganahin ang Webhooks',
                'performance_settings': 'Mga Performance Setting',
                'cache_duration': 'Tagal ng Cache',
                'seconds': 'segundo',
                'enable_caching': 'Paganahin ang Response Caching',
                'enable_compression': 'Paganahin ang GZIP Compression',
                'debug_settings': 'Mga Debug Setting',
                'enable_debug_mode': 'Paganahin ang Debug Mode',
                'debug_mode_help': 'Nagpapakita ng detailed error messages (para sa development lamang)',
                'log_level': 'Antas ng Log',
                'view_logs': 'Tingnan ang System Logs',
                'clear_cache': 'I-clear ang Cache',
                'discard_changes': 'Itapon ang mga Pagbabago',
                'save_settings': 'I-save ang mga Setting',
                'admin_dashboard': 'Admin Dashboard',
                'dashboard': 'Dashboard',
                'ticket_management': 'Pamamahala ng Ticket',
                'all_tickets': 'Lahat ng Ticket',
                'ticket_queue': 'Pila ng Ticket',
                'escalated_tickets': 'Na-escalate',
                'user_management': 'Pamamahala ng User',
                'users': 'Mga User',
                'support_agents': 'Mga Support Agent',
                'roles_permissions': 'Mga Role at Permissions',
                'analytics': 'Analytics',
                'reports': 'Mga Report',
                'performance': 'Performance',
                'insights': 'Mga Insight',
                'system_admin': 'System Admin',
                'announcements': 'Mga Anunsyo',
                'audit_log': 'Audit Log',
                'profile': 'Profile',
                'settings': 'Mga Setting',
                'logout': 'Mag-logout',
                'admin_dashboard_template': 'Admin Dashboard Template'
            }
        };

        // Check screen size on load and resize
        function checkScreenSize() {
            const mobileWarning = document.querySelector('.mobile-warning');
            const dashboardContent = document.querySelector('.app');

            if (window.innerWidth <= 768) {
                if (mobileWarning) mobileWarning.style.display = 'block';
                if (dashboardContent) dashboardContent.style.display = 'none';
            } else {
                if (mobileWarning) mobileWarning.style.display = 'none';
                if (dashboardContent) dashboardContent.style.display = 'flex';
            }
        }

        // Initialize the page when DOM is loaded
        document.addEventListener('DOMContentLoaded', function () {
            console.log('System Settings: Starting initialization...');

            // Check screen size
            checkScreenSize();

            // Load admin user data
            loadAndDisplayAdminData();

            // Initialize preferences manager
            if (window.preferencesManager) {
                console.log('System Settings: Initializing Preferences Manager...');
                window.preferencesManager.initialize();
                window.preferencesManager.applyTheme();

                const currentLang = window.preferencesManager.getCurrentLanguage() || 'en';
                applyTranslations(currentLang);

                // Set current language and theme in dropdowns
                setCurrentPreferences(currentLang);
            } else {
                console.error('System Settings: preferencesManager not found!');
                applyTranslations('en');
            }

            // Setup theme listener
            setupThemeListener();

            // Setup logout functionality
            setupLogout();

            // Setup account dropdown
            setupAccountDropdown();

            // Setup settings tabs
            setupSettingsTabs();

            // Setup form actions
            setupFormActions();

            // Setup preference change listeners
            setupPreferenceListeners();

            // Setup sidebar navigation with scroll preservation - SIMPLIFIED VERSION
            setupSidebarNavigation();

            console.log('System Settings page loaded');

            // Listen for storage events
            window.addEventListener('storage', function (e) {
                if (e.key === 'userData' || e.key === 'userProfile' || e.key === 'loggedInUser' || e.key === 'currentUser') {
                    console.log('User data changed in storage, reloading...');
                    loadAndDisplayAdminData();
                }
            });

            // Listen for resize events
            window.addEventListener('resize', checkScreenSize);
        });

        // Set current preferences in dropdowns
        function setCurrentPreferences(language) {
            const languageSelect = document.getElementById('defaultLanguage');
            const themeSelect = document.getElementById('defaultTheme');

            if (languageSelect) {
                languageSelect.value = language;
            }

            if (themeSelect && window.preferencesManager) {
                const currentTheme = window.preferencesManager.getCurrentTheme() || 'auto';
                themeSelect.value = currentTheme;
            }
        }

        // Setup preference change listeners
        function setupPreferenceListeners() {
            const languageSelect = document.getElementById('defaultLanguage');
            const themeSelect = document.getElementById('defaultTheme');

            if (languageSelect && window.preferencesManager) {
                languageSelect.addEventListener('change', function () {
                    const newLanguage = this.value;
                    window.preferencesManager.setLanguage(newLanguage);
                    applyTranslations(newLanguage);
                    console.log('Language changed to:', newLanguage);
                });
            }

            if (themeSelect && window.preferencesManager) {
                themeSelect.addEventListener('change', function () {
                    const newTheme = this.value;
                    window.preferencesManager.setTheme(newTheme);
                    console.log('Theme changed to:', newTheme);
                });
            }
        }

        // SIMPLIFIED VERSION: Setup sidebar navigation with scroll preservation
        function setupSidebarNavigation() {
            console.log('Setting up sidebar navigation...');

            const sidebarNav = document.getElementById('sidebarNav');
            const navLinks = document.querySelectorAll('.nav-link');

            if (!sidebarNav) {
                console.error('Sidebar navigation element not found!');
                return;
            }

            // Store current scroll position
            let currentScrollPosition = sidebarNav.scrollTop;

            // Save scroll position before any navigation
            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    // Save current scroll position
                    currentScrollPosition = sidebarNav.scrollTop;
                    console.log('Saved scroll position before click:', currentScrollPosition);

                    // Check if this is the current page
                    const href = this.getAttribute('href');
                    const currentUrl = window.location.href;

                    // Extract just the filename from URLs
                    const currentFile = currentUrl.split('/').pop().split('?')[0];
                    const targetFile = href.split('/').pop().split('?')[0];

                    console.log('Current file:', currentFile, 'Target file:', targetFile);

                    if (targetFile === currentFile) {
                        // Same page - prevent default navigation
                        e.preventDefault();

                        // Update active state
                        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                        this.classList.add('active');

                        // RESTORE SCROLL POSITION AFTER A TINY DELAY
                        setTimeout(() => {
                            sidebarNav.scrollTop = currentScrollPosition;
                            console.log('Restored scroll position to:', currentScrollPosition);
                        }, 10);
                    } else {
                        // Different page - save scroll position for return
                        localStorage.setItem('sidebarScrollPosition', currentScrollPosition);
                        console.log('Saved scroll position for next page:', currentScrollPosition);

                        // Let the link navigate normally
                        // The scroll position will be restored when user returns
                    }
                });
            });

            // Restore scroll position on page load
            const savedScrollPosition = localStorage.getItem('sidebarScrollPosition');
            if (savedScrollPosition) {
                setTimeout(() => {
                    sidebarNav.scrollTop = parseInt(savedScrollPosition);
                    console.log('Restored saved scroll position:', savedScrollPosition);

                    // Clear the saved position
                    localStorage.removeItem('sidebarScrollPosition');
                }, 100);
            }

            // Monitor scroll position changes
            sidebarNav.addEventListener('scroll', function () {
                currentScrollPosition = this.scrollTop;
            });

            console.log('Sidebar navigation setup complete');
        }

        // Load admin user data
        function loadAndDisplayAdminData() {
            try {
                console.log('Looking for admin user data...');

                // First check for admin-specific data
                const adminData = localStorage.getItem('adminData');
                if (adminData) {
                    const parsedData = JSON.parse(adminData);
                    updateUserDisplay(parsedData);
                    return;
                }

                // Fallback to regular user data
                const possibleKeys = [
                    'userData',
                    'userProfile',
                    'loggedInUser',
                    'currentUser',
                    'user',
                    'loginData',
                    'authData'
                ];

                let userData = null;

                for (const key of possibleKeys) {
                    const storedData = localStorage.getItem(key);
                    if (storedData) {
                        try {
                            const parsedData = JSON.parse(storedData);
                            if (parsedData && (parsedData.name || parsedData.email || parsedData.username || parsedData.fullName)) {
                                userData = parsedData;
                                // Add admin flag
                                userData.isAdmin = true;
                                userData.role = 'Administrator';
                                break;
                            }
                        } catch (e) {
                            console.log(`Data in "${key}" is not valid JSON`);
                        }
                    }
                }

                if (userData) {
                    updateUserDisplay(userData);
                } else {
                    // Default admin user
                    updateUserDisplay({
                        name: 'Administrator',
                        email: 'admin@allitrack.com',
                        initials: 'AD',
                        isAdmin: true,
                        role: 'System Administrator'
                    });
                }

            } catch (error) {
                console.error('Error loading admin data:', error);
                updateUserDisplay({
                    name: 'Administrator',
                    email: 'admin@allitrack.com',
                    initials: 'AD',
                    isAdmin: true,
                    role: 'System Administrator'
                });
            }
        }

        // Update user display in header
        function updateUserDisplay(userData) {
            console.log('Updating admin display with:', userData);

            const userNameDisplay = document.getElementById('userNameDisplay');
            const userEmailDisplay = document.getElementById('userEmailDisplay');
            const userAvatar = document.getElementById('userAvatar');

            if (userNameDisplay && userData) {
                const name = userData.name ||
                    userData.fullName ||
                    userData.username ||
                    (userData.firstName && userData.lastName ? `${userData.firstName} ${userData.lastName}` : null) ||
                    userData.email?.split('@')[0] ||
                    'Administrator';

                userNameDisplay.textContent = name;
            }

            if (userEmailDisplay && userData) {
                const email = userData.email ||
                    userData.userEmail ||
                    userData.emailAddress ||
                    'admin@allitrack.com';

                userEmailDisplay.textContent = email;
            }

            if (userAvatar && userData) {
                let initials = 'AD';
                const nameForInitials = userData.name ||
                    userData.fullName ||
                    userData.username ||
                    (userData.firstName && userData.lastName ? `${userData.firstName} ${userData.lastName}` : null);

                if (nameForInitials) {
                    initials = nameForInitials
                        .split(' ')
                        .map(n => n[0])
                        .join('')
                        .toUpperCase()
                        .substring(0, 2);
                } else if (userData.email) {
                    initials = userData.email.substring(0, 2).toUpperCase();
                }

                userAvatar.textContent = initials;

                if (userData.photo || userData.profilePicture || userData.avatar) {
                    const photoUrl = userData.photo || userData.profilePicture || userData.avatar;
                    userAvatar.style.backgroundImage = `url('${photoUrl}')`;
                    userAvatar.style.backgroundSize = 'cover';
                    userAvatar.style.backgroundPosition = 'center';
                    userAvatar.textContent = '';
                }
            }
        }

        // Setup theme listener
        function setupThemeListener() {
            console.log('Setting up theme listener for system settings...');

            window.addEventListener('storage', (event) => {
                if (event.key === 'preferredTheme') {
                    console.log('Theme changed via storage:', event.newValue);
                    if (window.preferencesManager) {
                        setTimeout(() => {
                            window.preferencesManager.applyTheme();
                            // Update theme dropdown
                            const themeSelect = document.getElementById('defaultTheme');
                            if (themeSelect) {
                                themeSelect.value = event.newValue || 'auto';
                            }
                        }, 100);
                    }
                }
            });

            document.addEventListener('themeChanged', function (e) {
                console.log('Theme changed via event:', e.detail.theme);
                if (window.preferencesManager) {
                    window.preferencesManager.applyTheme();
                    // Update theme dropdown
                    const themeSelect = document.getElementById('defaultTheme');
                    if (themeSelect) {
                        themeSelect.value = e.detail.theme || 'auto';
                    }
                }
            });
        }

        // Apply translations to the page
        function applyTranslations(language) {
            const lang = translations[language] ? language : 'en';
            const dict = translations[lang];

            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (dict[key]) {
                    element.textContent = dict[key];
                }
            });

            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (dict[key]) {
                    element.placeholder = dict[key];
                }
            });

            if (dict['system_settings_page_title']) {
                document.title = dict['system_settings_page_title'];
            }
        }

        // Listen for language changes
        document.addEventListener('languageChanged', function (e) {
            console.log('Language changed to:', e.detail.language);
            applyTranslations(e.detail.language);
            // Update language dropdown
            const languageSelect = document.getElementById('defaultLanguage');
            if (languageSelect) {
                languageSelect.value = e.detail.language;
            }
        });

        // Account Dropdown Functionality
        function setupAccountDropdown() {
            console.log('Setting up admin account dropdown...');
            const accountBtn = document.getElementById("accountBtn");
            const accountMenu = document.getElementById("accountMenu");

            if (accountBtn && accountMenu) {
                const newBtn = accountBtn.cloneNode(true);
                accountBtn.parentNode.replaceChild(newBtn, accountBtn);

                const refreshedBtn = document.getElementById("accountBtn");
                const refreshedMenu = document.getElementById("accountMenu");

                refreshedBtn.addEventListener("click", function (e) {
                    console.log('Admin account button clicked!');
                    e.stopPropagation();
                    e.preventDefault();

                    const isShowing = refreshedMenu.classList.contains("show");
                    refreshedMenu.classList.toggle("show");
                    refreshedBtn.setAttribute("aria-expanded", !isShowing);
                });

                document.addEventListener("click", function (e) {
                    if (!refreshedBtn.contains(e.target) && !refreshedMenu.contains(e.target)) {
                        refreshedMenu.classList.remove("show");
                        refreshedBtn.setAttribute("aria-expanded", false);
                    }
                });

                document.addEventListener("keydown", function (e) {
                    if (e.key === "Escape" && refreshedMenu.classList.contains("show")) {
                        refreshedMenu.classList.remove("show");
                        refreshedBtn.setAttribute("aria-expanded", false);
                    }
                });

                const menuItems = refreshedMenu.querySelectorAll("a");
                menuItems.forEach(item => {
                    item.addEventListener("click", function () {
                        refreshedMenu.classList.remove("show");
                        refreshedBtn.setAttribute("aria-expanded", false);
                    });
                });

                refreshedBtn.style.cursor = 'pointer';
                console.log('Admin account dropdown setup complete');
            } else {
                console.error('Admin account dropdown elements not found!');
            }
        }

        // Logout functionality
        function setupLogout() {
            const logoutBtn = document.getElementById("logoutBtn");
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function (e) {
                    e.preventDefault();

                    const keysToRemove = [
                        'userData',
                        'userProfile',
                        'loggedInUser',
                        'currentUser',
                        'user',
                        'loginData',
                        'authData',
                        'isLoggedIn',
                        'adminData'
                    ];

                    keysToRemove.forEach(key => {
                        localStorage.removeItem(key);
                    });

                    sessionStorage.clear();

                    window.location.href = '../../landing page/pages/index.html';
                });
            }
        }

        // Setup settings tabs
        function setupSettingsTabs() {
            const tabs = document.querySelectorAll('.settings-tab');
            const sections = document.querySelectorAll('.settings-section');

            tabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    const tabName = this.getAttribute('data-tab');

                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    // Show corresponding section
                    sections.forEach(section => {
                        section.classList.remove('active');
                        if (section.id === `${tabName}-settings`) {
                            section.classList.add('active');
                        }
                    });
                });
            });
        }

        // Setup form actions
        function setupFormActions() {
            // Save settings button
            const saveBtn = document.getElementById('saveSettingsBtn');
            if (saveBtn) {
                saveBtn.addEventListener('click', function () {
                    // In a real application, this would send data to server
                    console.log('Settings saved successfully!');

                    // Show subtle feedback without alert
                    const originalText = this.textContent;
                    this.innerHTML = '<i class="fas fa-check"></i> Saved';
                    this.style.background = '#10B981';

                    setTimeout(() => {
                        this.innerHTML = originalText;
                        this.style.background = '';
                    }, 2000);
                });
            }

            // Discard changes button
            const discardBtn = document.querySelector('.settings-actions .btn-secondary');
            if (discardBtn) {
                discardBtn.addEventListener('click', function () {
                    // Just reload the page to discard changes
                    location.reload();
                });
            }

            // Category management
            const categoryAddBtn = document.querySelector('.category-add .btn');
            if (categoryAddBtn) {
                categoryAddBtn.addEventListener('click', function () {
                    const input = this.previousElementSibling;
                    const value = input.value.trim();

                    if (value) {
                        const categoriesList = document.querySelector('.categories-list');
                        const newCategory = document.createElement('div');
                        newCategory.className = 'category-tag';
                        newCategory.innerHTML = `
                        <span>${value}</span>
                        <button class="category-remove"><i class="fas fa-times"></i></button>
                    `;
                        categoriesList.appendChild(newCategory);
                        input.value = '';

                        // Add event listener to remove button
                        newCategory.querySelector('.category-remove').addEventListener('click', function () {
                            newCategory.remove();
                        });
                    }
                });
            }

            // Initialize category remove buttons
            document.querySelectorAll('.category-remove').forEach(button => {
                button.addEventListener('click', function () {
                    this.parentElement.remove();
                });
            });

            // Backup now button
            const backupBtn = document.querySelector('[data-translate="backup_now"]');
            if (backupBtn) {
                backupBtn.addEventListener('click', function () {
                    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Backing up...';
                    this.disabled = true;

                    setTimeout(() => {
                        this.innerHTML = 'Backup Now';
                        this.disabled = false;
                        console.log('Backup completed successfully!');
                    }, 2000);
                });
            }

            // Check updates button
            const updateBtn = document.querySelector('[data-translate="check_updates"]');
            if (updateBtn) {
                updateBtn.addEventListener('click', function () {
                    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Checking...';
                    this.disabled = true;

                    setTimeout(() => {
                        this.innerHTML = 'Check for Updates';
                        this.disabled = false;
                        console.log('System is up to date!');
                    }, 1500);
                });
            }
        }

        // Listen for user data changes
        document.addEventListener('userDataChanged', function (e) {
            console.log('User data changed event received:', e.detail);
            if (e.detail && e.detail.userData) {
                updateUserDisplay(e.detail.userData);
            }
        });
    </script>
</body>

</html>